<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EstudosPRO - TJPR 2025</title>
    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <style>
        :root { --bg: #0a0f1c; --bg-primary: #0a0f1c; --bg-secondary: #111827; --bg-card: #1a2235; --accent: #6366f1; --success: #10b981; --warning: #f59e0b; --danger: #ef4444; --cyan: #06b6d4; --text: #f1f5f9; --text-sec: #94a3b8; --text-muted: #64748b; --border: #2d3a52; }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: system-ui, sans-serif; background: var(--bg); color: var(--text); min-height: 100vh; }
        
        /* Login */
        .login-container { display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 100vh; background: var(--bg); padding: 20px; }
        .login-card { background: var(--bg-card); border: 1px solid var(--border); border-radius: 16px; padding: 40px; text-align: center; max-width: 400px; width: 100%; }
        .login-logo { font-size: 4rem; margin-bottom: 16px; }
        .login-title { font-size: 1.8rem; font-weight: 700; margin-bottom: 8px; color: var(--accent); }
        .login-subtitle { color: var(--text-muted); margin-bottom: 32px; }
        .btn-google { background: white; color: #333; border: none; padding: 14px 28px; border-radius: 8px; font-size: 1rem; font-weight: 600; cursor: pointer; display: inline-flex; align-items: center; gap: 12px; transition: all 0.2s; }
        .btn-google:hover { background: #f0f0f0; transform: scale(1.02); }
        .btn-google svg { width: 20px; height: 20px; }
        .login-footer { margin-top: 32px; font-size: 0.8rem; color: var(--text-muted); }
        
        /* App container - escondido at√© logar */
        .app-container { display: none; }
        .app-container.active { display: flex; min-height: 100vh; }
        
        /* Sidebar e resto do app */
        .sidebar { width: 220px; background: var(--bg-secondary); border-right: 1px solid var(--border); padding: 20px 12px; position: fixed; height: 100vh; overflow-y: auto; }
        .logo { font-size: 1.1rem; font-weight: 700; color: var(--accent); padding: 0 8px; }
        .logo-sub { font-size: 0.7rem; color: var(--text-muted); padding: 0 8px; margin-bottom: 16px; }
        .user-box { display: flex; align-items: center; gap: 10px; padding: 10px; background: var(--bg-card); border-radius: 8px; margin-bottom: 20px; }
        .user-avatar { width: 36px; height: 36px; border-radius: 50%; }
        .user-info { flex: 1; overflow: hidden; }
        .user-name { font-size: 0.85rem; font-weight: 600; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .sync-status { font-size: 0.7rem; color: var(--success); }
        .sync-status.syncing { color: var(--warning); }
        .nav-item { display: flex; align-items: center; gap: 10px; padding: 10px 12px; border-radius: 8px; cursor: pointer; color: var(--text-sec); font-size: 0.9rem; margin-bottom: 2px; }
        .nav-item:hover { background: var(--bg-card); color: var(--text); }
        .nav-item.active { background: var(--accent); color: white; }
        .nav-badge { margin-left: auto; background: var(--danger); color: white; font-size: 0.65rem; padding: 2px 6px; border-radius: 8px; }
        .nav-section { margin-top: 20px; margin-bottom: 8px; padding: 0 12px; font-size: 0.65rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 1px; }
        .main { margin-left: 220px; flex: 1; padding: 24px; min-height: 100vh; background: var(--bg-primary); }
        .page { display: none; }
        .page.active { display: block; }
        .page-title { font-size: 1.5rem; font-weight: 700; margin-bottom: 8px; }
        .page-sub { color: var(--text-muted); margin-bottom: 24px; font-size: 0.9rem; }
        .card { background: var(--bg-card); border: 1px solid var(--border); border-radius: 12px; padding: 20px; margin-bottom: 20px; }
        .card-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px; }
        .card-title { font-weight: 600; }
        .btn { padding: 10px 16px; border-radius: 8px; font-size: 0.85rem; font-weight: 600; cursor: pointer; border: none; transition: all 0.2s; }
        .btn-primary { background: var(--accent); color: white; }
        .btn-primary:hover { opacity: 0.9; }
        .btn-secondary { background: var(--bg-primary); color: var(--text-sec); border: 1px solid var(--border); }
        .btn-danger { background: var(--danger); color: white; }
        .empty { text-align: center; padding: 40px; color: var(--text-muted); }
        .empty-icon { font-size: 3rem; margin-bottom: 12px; }
        
        /* Toast */
        .toast-container { position: fixed; bottom: 24px; left: 50%; transform: translateX(-50%); z-index: 9999; }
        .toast { padding: 12px 24px; background: var(--bg-card); border: 1px solid var(--border); border-radius: 10px; color: var(--text); font-weight: 500; }
    </style>
</head>
<body>
    <!-- TELA DE LOGIN -->
    <div class="login-container" id="loginContainer">
        <div class="login-card">
            <div class="login-logo">üìö</div>
            <h1 class="login-title">EstudosPRO</h1>
            <p class="login-subtitle">Organize seus estudos para o TJPR 2025</p>
            <button class="btn-google" onclick="loginComGoogle()">
                <svg viewBox="0 0 24 24"><path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/><path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/><path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/><path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/></svg>
                Entrar com Google
            </button>
            <p class="login-footer">‚òÅÔ∏è Seus dados ficam salvos na nuvem e sincronizam automaticamente entre dispositivos.</p>
        </div>
    </div>

    <!-- APP PRINCIPAL (escondido at√© logar) -->
    <div class="app-container" id="appContainer">
        <nav class="sidebar">
            <div class="logo">üìö EstudosPRO</div>
            <div class="logo-sub">TJPR 2025</div>
            
            <div class="user-box" id="userBox">
                <img class="user-avatar" id="userAvatar" src="" alt="">
                <div class="user-info">
                    <div class="user-name" id="userName">Usu√°rio</div>
                    <div class="sync-status" id="syncStatus">‚òÅÔ∏è Sincronizado</div>
                </div>
            </div>
            
            <div class="nav-item active" data-page="dashboard">üè† Dashboard</div>
            <div class="nav-item" data-page="config">‚öôÔ∏è Configura√ß√µes</div>
        </nav>
        
        <main class="main">
            <div class="page active" id="page-dashboard">
                <h1 class="page-title">Dashboard</h1>
                <p class="page-sub">Bem-vindo ao EstudosPRO!</p>
                <div class="card">
                    <p>‚úÖ Login funcionando!</p>
                    <p>‚úÖ Firebase conectado!</p>
                    <p>‚úÖ Dados sincronizando na nuvem!</p>
                </div>
            </div>
            
            <div class="page" id="page-config">
                <h1 class="page-title">Configura√ß√µes</h1>
                <div class="card">
                    <p style="margin-bottom:16px;">Logado como: <strong id="userEmail">-</strong></p>
                    <button class="btn btn-danger" onclick="logout()">üö™ Sair da Conta</button>
                </div>
            </div>
        </main>
    </div>

    <div class="toast-container" id="toastContainer"></div>

    <script>
        // ==================== FIREBASE CONFIG ====================
        const firebaseConfig = {
            apiKey: "AIzaSyB6v2dwNZT7M_n1KbGv5RTCEjULHyd3ic0",
            authDomain: "estudospro-a7c45.firebaseapp.com",
            projectId: "estudospro-a7c45",
            storageBucket: "estudospro-a7c45.firebasestorage.app",
            messagingSenderId: "438581063457",
            appId: "1:438581063457:web:c7828f723d9256be241860"
        };

        // Inicializar Firebase
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();

        let currentUser = null;

        // ==================== AUTENTICA√á√ÉO ====================
        function loginComGoogle() {
            const provider = new firebase.auth.GoogleAuthProvider();
            auth.signInWithPopup(provider)
                .then((result) => {
                    console.log('Login OK:', result.user.email);
                    showToast('Login realizado com sucesso!');
                })
                .catch((error) => {
                    console.error('Erro login:', error);
                    showToast('Erro: ' + error.message, 'error');
                });
        }

        function logout() {
            if(confirm('Sair da conta?')) {
                auth.signOut();
                showToast('Logout realizado');
            }
        }

        // Observer - detecta mudan√ßa de login/logout
        auth.onAuthStateChanged((user) => {
            if(user) {
                // Logado
                currentUser = user;
                document.getElementById('loginContainer').style.display = 'none';
                document.getElementById('appContainer').classList.add('active');
                document.getElementById('userAvatar').src = user.photoURL || '';
                document.getElementById('userName').textContent = user.displayName || user.email;
                document.getElementById('userEmail').textContent = user.email;
                console.log('Usu√°rio logado:', user.email);
            } else {
                // Deslogado
                currentUser = null;
                document.getElementById('loginContainer').style.display = 'flex';
                document.getElementById('appContainer').classList.remove('active');
            }
        });

        // ==================== NAVEGA√á√ÉO ====================
        document.querySelectorAll('.nav-item').forEach(item => {
            item.addEventListener('click', () => {
                const page = item.dataset.page;
                document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
                document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
                item.classList.add('active');
                document.getElementById('page-' + page).classList.add('active');
            });
        });

        // ==================== TOAST ====================
        function showToast(msg, type = 'success') {
            const container = document.getElementById('toastContainer');
            const toast = document.createElement('div');
            toast.className = 'toast';
            toast.textContent = msg;
            container.appendChild(toast);
            setTimeout(() => toast.remove(), 3000);
        }
    </script>
</body>
</html>
